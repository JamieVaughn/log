{"pageProps":{"post":{"title":"Simple State Reducer With Objects, Switch-Case & Generators","date":"2019-12-28T20:47:18.322Z","slug":"state_reducers","author":{"name":"Jamie Vaughn","picture":"/authors/jj.jpeg"},"content":"<p>Finite State Machines and State management is now an important part of frontend development. Libraries like Redux, XState and Microstates.js are creeping into wide spread use, especially in the React community. Those libraries provide a robust and complex solution to state management and are well suited to production applications. But for learning the concept of State Reducers and Finite State Management let's build a super simple <strong>State Reducer</strong> in three different ways:</p>\n<ul>\n<li>Object Lookup-Table</li>\n<li>Switch-Case statement</li>\n<li>Generator function</li>\n</ul>\n<p>A state reducer takes in a state and an action and returns a new state in a deterministic fashion. It's referred to as a reducer because it reduces two inputs into a single state as an output. The deterministic part of this meshes nicely with functional programming, because it can be expressed with pure functions.</p>\n<h2>Object Lookup-Table</h2>\n<p>The lookup-table provides an easy way to map a state value to an enum by way of a key in an object. It can also serve as something like a Class, since various methods can be attached to the object as well (but do not have to be).</p>\n<pre><code class=\"language-js\">const stateReducer = {\n  current: &quot;red&quot;,\n  red: &quot;green&quot;,\n  yellow: &quot;red&quot;,\n  green: &quot;yellow&quot;,\n  next: function () {\n    this.current = this[this.current];\n  },\n  getState: function () {\n    console.log(this.current);\n  },\n};\n</code></pre>\n<h2>Switch-Case Statement</h2>\n<p>The swtch statement is the go-to reducer pattern in the React-Redux world. It's very straight forward and also at least as powerful as the lookup-table. In certain cases, it can be more flexible and powerful than the lookup-table. It is not as concise, though and can't contain related methods within it. When inside a function the new state string can be returned instead of reassigned.</p>\n<pre><code class=\"language-js\">switch (action) {\n  case &quot;red&quot;:\n    state = &quot;green&quot;;\n    break;\n  case &quot;yellow&quot;:\n    state = &quot;red&quot;;\n    break;\n  case &quot;green&quot;:\n    state = &quot;yellow&quot;;\n    break;\n  default:\n    state = &quot;green&quot;;\n    break;\n}\n</code></pre>\n<h2>Generator Function</h2>\n<p>The generator function can also be used as a reducer, although it rarely is since it is quite new to Javascript. A perpetual <code>while</code> loop can be used to make the generator continuously yield state values.</p>\n<pre><code class=\"language-js\">function* stateReducer(state) {\n  let states = [&quot;green&quot;, &quot;yellow&quot;, &quot;red&quot;];\n  let nextState = (states.indexOf(state) + 1) % 3;\n  while (states.includes(state)) {\n    yield states[nextState];\n  }\n  yield state; // a default state return value\n}\n\nstateReducer(&quot;green&quot;).next(); // {value: &quot;yellow&quot;, done: false}\n</code></pre>\n<h2>Action Routers</h2>\n<p>All of these approaches simply map an action type to an execution block (i.e. a function) with a predetermined set of logic. This is similar to a page router, which determines what content to dispay on the page (a.k.a. &quot;state&quot;) given a particular URL query string or path. We can think of this pattern as a &quot;Action Router&quot; since it maps particular action objects, enums or strings to a given function, which determines the next application state. In fact, the concept of a page router and a state reducer are not just &quot;similar&quot; they are pretty much the same. A page router controls the whole page and is inextricably linked to the URL string state, while the state reducer controls some object's state in memory, which may impact potentially the whole page or merely a bit of information in the background. There is no necessary specification or ceremony around the state object, like there is around the URL, but state management libraries like Redux do introduce and enforce some level of convention to make things more consistent when interacting with the state object (a.k.a. the <code>store</code>).</p>\n","ogImage":{"url":"/img/cover.jpg"},"coverImage":"/img/cover.jpg"}},"__N_SSG":true}